<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Katrin Fitmas ‚Äì Advent Training Calendar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #020617;
      color: #f7f7ff;
    }

    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background:
        radial-gradient(circle at top, rgba(56, 189, 248, 0.3), transparent 55%),
        radial-gradient(circle at bottom, rgba(129, 140, 248, 0.22), transparent 55%),
        linear-gradient(180deg, #020617 0%, #02041b 50%, #020617 100%);
      overflow-x: hidden;
    }

    /* Snowflakes container */
    .snowflakes {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }

    .snowflake {
      position: absolute;
      top: -10%;
      color: rgba(255, 255, 255, 0.8);
      animation-name: fall;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
      will-change: transform;
    }

    @keyframes fall {
      0% {
        transform: translateY(0) translateX(0) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      100% {
        transform: translateY(110vh) translateX(30px) rotate(360deg);
        opacity: 0;
      }
    }

    /* Intro Overlay */
    #intro {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(56,189,248,0.35), transparent 60%), #020617;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 2rem;
      z-index: 200;
    }

    #intro h1 {
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    #intro p {
      font-size: 1rem;
      color: #c7c9ff;
      margin-bottom: 2rem;
      max-width: 520px;
      line-height: 1.5;
    }

    #intro button {
      padding: 0.6rem 1.4rem;
      background: #4f46e5;
      color: #fff;
      border: none;
      border-radius: 999px;
      font-size: 1rem;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(79,70,229,0.6);
      transition: 0.2s ease;
    }

    #intro button:hover {
      background: #6366f1;
      transform: translateY(-1px);
    }

    .page {
      max-width: 960px;
      margin: 0 auto;
      padding: 2rem 1rem 3rem;
      display: none;
      position: relative;
      z-index: 1;
    }

    h1 {
      text-align: center;
      font-size: 2rem;
      margin: 0 0 0.25rem;
    }

    .subtitle {
      text-align: center;
      margin-bottom: 2rem;
      color: #c7c9ff;
    }

    /* Grid */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 1rem;
    }

    /* Fade-in animation */
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* Card */
    .card {
      background: transparent;
      perspective: 1000px;
      height: 260px;          /* mehr Platz -> kein √úberlappen */
      box-sizing: border-box;
      opacity: 0;
      animation: fadeUp 0.6s ease forwards;
    }

    @media (max-width: 600px) {
      .card {
        height: 300px;        /* auf Handy noch etwas h√∂her */
      }
    }

    .card-inner {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.6s;
    }

    .card.flipped .card-inner {
      transform: rotateX(180deg);
    }

    .card-face {
      position: absolute;
      inset: 0;
      background: rgba(15, 23, 42, 0.96);
      border-radius: 0.9rem;
      padding: 0.85rem 1rem;
      border: 1px solid rgba(148, 163, 184, 0.35);
      box-shadow: 0 12px 40px rgba(15, 23, 42, 0.9);
      display: flex;
      flex-direction: column;
      gap: 0.55rem;
      backface-visibility: hidden;
      box-sizing: border-box;
      overflow: hidden;
    }

    .card-front {
      transform: rotateX(0deg);
    }

    .card-back {
      transform: rotateX(180deg);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 0.5rem;
      flex-shrink: 0;
    }

    .day-label {
      font-weight: 600;
      font-size: 1rem;
    }

    .intensity {
      font-size: 0.75rem;
      padding: 0.15rem 0.5rem;
      border-radius: 999px;
      background: rgba(79, 70, 229, 0.18);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #e8ecff;
      display: flex;
      align-items: center;
      gap: 0.3rem;
      flex-shrink: 0;
    }

    .icon {
      font-size: 1.1rem;
    }

    .text {
      flex: 1;
      font-size: 0.9rem;
      color: #e3e4ff;
      line-height: 1.4;
      white-space: pre-line;
      overflow-y: auto;
    }

    .btn,
    .btn-secondary {
      padding: 0.4rem 0.75rem;
      border-radius: 999px;
      border: none;
      text-transform: uppercase;
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.15s ease, transform 0.05s ease, box-shadow 0.15s ease;
      align-self: flex-start;
    }

    .btn {
      background: #4f46e5;
      color: #fff;
      box-shadow: 0 6px 18px rgba(79, 70, 229, 0.4);
    }

    .btn-secondary {
      background: #16a34a;
      color: #fff;
      box-shadow: 0 6px 18px rgba(22, 163, 74, 0.4);
    }

    .btn:hover {
      background: #6366f1;
      transform: translateY(-1px);
    }

    .btn-secondary:hover {
      background: #22c55e;
      transform: translateY(-1px);
    }

    .toast {
      position: fixed;
      left: 50%;
      bottom: 1.5rem;
      transform: translateX(-50%);
      background: #22c55e;
      color: #022c16;
      padding: 0.5rem 1rem;
      border-radius: 999px;
      font-size: 0.8rem;
      box-shadow: 0 8px 22px rgba(0, 0, 0, 0.4);
      opacity: 0;
      pointer-events: none;
      transition: 0.2s ease;
      z-index: 50;
    }

    .toast.show {
      opacity: 1;
      transform: translate(-50%, -4px);
    }

    /* Today + past effect */
    .today-card .card-face {
      box-shadow: 0 0 28px rgba(96, 165, 250, 0.9);
      border-color: rgba(129, 140, 248, 0.95);
    }

    .past-card .card-face {
      opacity: 0.7;
      filter: grayscale(18%);
    }

    /* Admin info footer */
    .admin-footer {
      text-align: center;
      margin-top: 3rem;
      font-size: 0.85rem;
      color: #9ca3af;
    }

    /* Confetti */
    .confetti-piece {
      position: absolute;
      width: 6px;
      height: 10px;
      border-radius: 2px;
      animation: confetti-fall 1.2s ease-out forwards;
      z-index: 60;
    }

    @keyframes confetti-fall {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(60px) rotate(260deg); opacity: 0; }
    }
  </style>
</head>
<body>

  <!-- Dynamic Snowflakes -->
  <div class="snowflakes" aria-hidden="true"></div>

  <!-- INTRO -->
  <div id="intro">
    <h1>üéÑ Welcome to your Fitmas Advent üéÑ</h1>
    <p>
      Every day in December a new workout unlocks ‚Äì like a sporty advent calendar.<br>
      Some days are hard, some are just mobility or recovery. Always listen to your body.
    </p>
    <button id="intro-btn">Start</button>
  </div>

  <!-- MAIN PAGE -->
  <div class="page">
    <h1>Katrin Fitmas ‚Äì Advent Training</h1>
    <p class="subtitle">One new workout per day in December.</p>

    <div id="grid" class="grid"></div>

    <div class="admin-footer">
      (Admin view: add <strong>?admin=true</strong> to the URL)
    </div>
  </div>

  <div id="toast" class="toast"></div>

<script>
/* ---------- SNOWFLAKES (mit mehr Effekten) ---------- */
(function createSnowflakes() {
  const container = document.querySelector(".snowflakes");
  const symbols = ["‚ùÑ","‚ú¶","‚úß","‚ùÖ","‚ú∂"];
  const COUNT = 70;  // ‚¨Ö‚¨Ö‚¨Ö HIER: Anzahl der Flocken

  for (let i = 0; i < COUNT; i++) {
    const flake = document.createElement("div");
    flake.className = "snowflake";
    flake.textContent = symbols[Math.floor(Math.random() * symbols.length)];

    const delay = Math.random() * 10;
    const duration = 10 + Math.random() * 12;
    const left = Math.random() * 100;
    const size = 0.6 + Math.random() * 1.1;         // unterschiedliche Gr√∂√üen
    const opacity = 0.3 + Math.random() * 0.6;      // unterschiedliche Helligkeit

    flake.style.left = left + "vw";
    flake.style.animationDelay = delay + "s";
    flake.style.animationDuration = duration + "s";
    flake.style.fontSize = size + "rem";
    flake.style.opacity = opacity;

    container.appendChild(flake);
  }
})();

/* ---------- WORKOUT DATA ---------- */
const workouts = [
  { day:1, intensity:"Workout", icon:"üèãüèº‚Äç‚ôÄÔ∏è", text:"Mobility/Core: 45 min mobility & core." },
  { day:2, intensity:"Skitour Easy", icon:"‚õ∑Ô∏è", text:"Skitour: 600‚Äì800 hm in Z2 at steady cadence." },
  { day:3, intensity:"Recovery", icon:"üí§", text:"Run: 30 min very easy recovery in Z1." },
  { day:4, intensity:"Threshold Uphill", icon:"üî•", text:"Run: 15 min warmup in Z1, 4 √ó 6 min uphill in Z4, easy cooldown." },
  { day:5, intensity:"Trail Endurance", icon:"üå≤", text:"Run: 60 min trail run in Z2." },
  { day:6, intensity:"Skitour Technique", icon:"‚õ∑Ô∏è", text:"Skitour: 700‚Äì900 hm in Z2, focus on smooth technique." },
  { day:7, intensity:"Long Endurance", icon:"üèÉ‚Äç‚ôÄÔ∏è", text:"Run: 90 min endurance run in Z2." },
  { day:8, intensity:"VO2max", icon:"üöÄ", text:"Run: 6 √ó 3 min in Z5 with easy recovery between intervals." },
  { day:9, intensity:"Workout", icon:"üèãüèº‚Äç‚ôÄÔ∏è", text:"Mobility/Core: 45 min focused strength & stability work." },
  { day:10,intensity:"Skitour Sweet Spot", icon:"‚õ∑Ô∏è", text:"Skitour: ~1000 hm with 2 √ó 15 min uphill in Z3, rest in Z2." },
  { day:11,intensity:"Threshold", icon:"üî•", text:"Run: 25 min continuous threshold in Z4 after easy warmup." },
  { day:12,intensity:"Trail Endurance", icon:"üå≤", text:"Run: 50 min easy trail run in Z2." },
  { day:13,intensity:"Skitour Steady", icon:"‚õ∑Ô∏è", text:"Skitour: 900‚Äì1100 hm in Z2‚ÄìZ3, steady pacing." },
  { day:14,intensity:"Workout", icon:"üèãüèº‚Äç‚ôÄÔ∏è", text:"Mobility/Core: 45 min mobility & core workout." },
  { day:15,intensity:"Easy Run", icon:"üèÉ‚Äç‚ôÄÔ∏è", text:"Run: 45 min relaxed endurance in Z2." },
  { day:16,intensity:"Skitour Technique", icon:"‚õ∑Ô∏è", text:"Skitour: 700‚Äì900 hm, focus on transitions and efficiency." },
  { day:17,intensity:"Recovery", icon:"üí§", text:"Run: 25 min very easy run or brisk walk in Z1." },
  { day:18,intensity:"Threshold", icon:"üî•", text:"Run: 3 √ó 8 min in Z4 with 3 min easy between." },
  { day:19,intensity:"Easy Run", icon:"üèÉ‚Äç‚ôÄÔ∏è", text:"Run: 45 min easy endurance in Z2." },
  { day:20,intensity:"Skitour Uphill", icon:"‚õ∑Ô∏è", text:"Skitour: ~1000 hm with one 20 min section in Z3, otherwise Z2." },
  { day:21,intensity:"Workout", icon:"üèãüèº‚Äç‚ôÄÔ∏è", text:"Mobility/Core: 45 min mobility & core workout." },
  { day:22,intensity:"VO2max Uphill", icon:"üöÄ", text:"Run: 8 √ó 2 min uphill in Z5 with 2 min easy jog between." },
  { day:23,intensity:"Recovery", icon:"üí§", text:"Run: 30 min very easy Z1 or relaxed walk." },
  { day:24,intensity:"Final Skitour", icon:"‚õ∑Ô∏è", text:"Skitour: 1200‚Äì1500 hm in Z2. Enjoy the views and celebrate your Fitmas journey!" }
];

/* ---------- ADMIN & INTRO ---------- */
const isAdmin = new URLSearchParams(window.location.search).get("admin") === "true";
const intro = document.getElementById("intro");
const page = document.querySelector(".page");

document.getElementById("intro-btn").onclick = () => {
  intro.style.display = "none";
  page.style.display = "block";
  if (!isAdmin) localStorage.setItem("advent_intro_shown", "yes");
};

if (isAdmin) {
  intro.style.display = "none";
  page.style.display = "block";
} else if (localStorage.getItem("advent_intro_shown") === "yes") {
  intro.style.display = "none";
  page.style.display = "block";
}

function getVisibleDayLimit() {
  if (isAdmin) return 24;
  const now = new Date();
  return now.getMonth() === 11 ? Math.min(now.getDate(), 24) : 0;
}

function getTodayDay() {
  const now = new Date();
  return now.getMonth() === 11 ? now.getDate() : null;
}

/* ---------- TOAST ---------- */
const toast = document.getElementById("toast");
const toastMessages = [
  "You've got this! üí™",
  "Consistency wins. ‚≠ê",
  "Strong & steady! üèîÔ∏è",
  "Sellaronda is getting closer. ‚õ∑Ô∏è",
  "Make it count today. üî•",
  "Winning the day! üìÜ",
  "Future you is cheering. üôå",
  "One step stronger. ‚ö°",
  "Great choice ‚Äì go for it! üéâ",
  "Beautiful effort incoming. ‚ú®",
  "This is athlete mode. üèÖ",
  "Breathe, move, enjoy. üå¨Ô∏è"
];

function showToast() {
  toast.textContent = toastMessages[Math.floor(Math.random() * toastMessages.length)];
  toast.classList.add("show");
  setTimeout(() => toast.classList.remove("show"), 1500);
}

/* ---------- CONFETTI ---------- */
function launchConfetti(card, mult = 1) {
  const rect = card.getBoundingClientRect();
  const colors = ["#f97316", "#facc15", "#22c55e", "#38bdf8", "#a855f7", "#f472b6"];
  const baseCount = 14;
  const count = Math.round(baseCount * mult);

  for (let i = 0; i < count; i++) {
    const piece = document.createElement("div");
    piece.className = "confetti-piece";
    piece.style.background = colors[Math.floor(Math.random() * colors.length)];
    piece.style.left = rect.left + rect.width / 2 + (Math.random() * 80 - 40) + "px";
    piece.style.top = rect.top + 20 + Math.random() * 40 + "px";
    document.body.appendChild(piece);
    setTimeout(() => piece.remove(), 1300);
  }
}

/* ---------- RENDER CARDS ---------- */
function renderWorkouts() {
  const grid = document.getElementById("grid");
  const visibleLimit = getVisibleDayLimit();
  const today = getTodayDay();

  workouts
    .filter(w => w.day <= visibleLimit)
    .forEach((w, idx) => {
      const card = document.createElement("div");
      card.className = "card";
      card.style.animationDelay = (idx * 0.06) + "s";

      const inner = document.createElement("div");
      inner.className = "card-inner";

      // FRONT
      const front = document.createElement("div");
      front.className = "card-face card-front";

      const headerFront = document.createElement("div");
      headerFront.className = "card-header";
      headerFront.innerHTML = `
        <div class="day-label">Day ${w.day}</div>
        <div class="intensity"><span class="icon">${w.icon}</span>${w.intensity}</div>
      `;

      const textFront = document.createElement("div");
      textFront.className = "text";
      textFront.textContent = "Tap ‚ÄúLet's go‚Äù to reveal today's workout.";

      const goBtn = document.createElement("button");
      goBtn.className = "btn-secondary";
      goBtn.textContent = "Let's go";

      front.appendChild(headerFront);
      front.appendChild(textFront);
      front.appendChild(goBtn);

      // BACK
      const back = document.createElement("div");
      back.className = "card-face card-back";

      const headerBack = document.createElement("div");
      headerBack.className = "card-header";
      headerBack.innerHTML = `
        <div class="day-label">Day ${w.day}</div>
        <div class="intensity"><span class="icon">${w.icon}</span>${w.intensity}</div>
      `;

      const textBack = document.createElement("div");
      textBack.className = "text";
      textBack.textContent = w.text;

      const copyBtn = document.createElement("button");
      copyBtn.className = "btn";
      copyBtn.textContent = "Copy workout";
      copyBtn.onclick = () => {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard.writeText(w.text).then(showToast).catch(showToast);
        } else {
          const ta = document.createElement("textarea");
          ta.value = w.text;
          document.body.appendChild(ta);
          ta.select();
          document.execCommand("copy");
          document.body.removeChild(ta);
          showToast();
        }
      };

      back.appendChild(headerBack);
      back.appendChild(textBack);
      back.appendChild(copyBtn);

      inner.appendChild(front);
      inner.appendChild(back);
      card.appendChild(inner);

      // Today / past styling
      if (today && w.day === today) {
        card.classList.add("today-card");
      } else if (today && w.day < today) {
        card.classList.add("past-card");
      }

      // Confetti on 7, 14, 21, 24
      goBtn.onclick = () => {
        card.classList.add("flipped");
        if ([7, 14, 21].includes(w.day)) {
          launchConfetti(card, 1.3);
        } else if (w.day === 24) {
          launchConfetti(card, 2.3);
          setTimeout(() => launchConfetti(card, 1.8), 350);
        }
      };

      grid.appendChild(card);
    });
}

renderWorkouts();
</script>
</body>
</html>
